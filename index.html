<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fine Graphics - Premium Design Services</title>

    <style>
        /* fix the ui suitable for mobile*/
        /* fix the ui suitable for mobile*/
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Arial', sans-serif;
    line-height: 1.6;
    color: #333;
    background-color: #f8f9fa;
}

/* Header Styles */
header {
    background: linear-gradient(135deg, 
        rgba(102, 126, 234, 0.9) 0%, 
        rgba(118, 75, 162, 0.9) 100%);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    color: white;
    padding: 1rem 0;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    position: relative;
    z-index: 1000; /* Ensure header creates stacking context */
}

.nav-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.logo {
    font-size: 1.8rem;
    font-weight: bold;
}

.logo span {
    color: #ffd700;
}

/* Original PC Navigation */
nav ul {
    list-style: none;
    display: flex;
    gap: 2rem;
}

nav a {
    color: white;
    text-decoration: none;
    transition: color 0.3s;
}

nav a:hover {
    color: #ffd700;
}

/* Profile Dropdown Styles */
.profile-dropdown {
    position: relative;
}

.profile-dropdown-menu {
    position: absolute;
    top: 100%;
    right: 0;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    box-shadow: 
        0 15px 35px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.6);
    min-width: 200px;
    z-index: 1002; /* Ensure dropdown menu is above everything */
    display: none;
    margin-top: 0.5rem;
}

.profile-dropdown-menu.show {
    display: block;
    animation: fadeIn 0.2s ease-in-out;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}

.profile-menu-toggle {
    background: none;
    border: none;
    color: white;
    font-size: 1.5rem;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 50%;
    transition: background-color 0.3s;
}

.profile-menu-toggle:hover {
    background: rgba(255, 255, 255, 0.1);
}

.profile-header {
    padding: 1rem;
    border-bottom: 1px solid #eee;
    text-align: center;
}

.profile-avatar {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid #667eea;
    margin-bottom: 0.5rem;
}

.profile-username {
    font-weight: bold;
    color: #333;
    margin: 0;
    font-size: 1rem;
}

.profile-email {
    color: #666;
    margin: 0;
    font-size: 0.8rem;
}

.profile-menu-items {
    padding: 0.5rem 0;
}

.profile-menu-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    color: #333;
    text-decoration: none;
    border: none;
    background: none;
    width: 100%;
    text-align: left;
    cursor: pointer;
    font-size: 0.9rem;
    transition: background-color 0.3s;
}

.profile-menu-item:hover {
    background: #f8f9fa;
}

.profile-menu-item.logout {
    color: #dc3545;
    border-top: 1px solid #eee;
}

.profile-menu-item.logout:hover {
    background: #fff5f5;
}

/* Preview Gallery Styles */
.preview-gallery {
    position: relative;
    margin-bottom: 1rem;
    text-align: center;
}

.preview-image {
    max-width: 100%;
    max-height: 500px;
    width: auto;
    height: auto;
    object-fit: contain;
    border-radius: 10px;
    margin-bottom: 1rem;
    border: 1px solid #ddd;
    background: #f8f9fa;
}

.preview-thumbnails {
    display: flex;
    gap: 8px;
    margin: 15px 0;
    overflow-x: auto;
    padding: 10px 0;
    justify-content: center;
    flex-wrap: wrap;
}

.preview-thumbnail {
    width: 60px;
    height: 60px;
    border: 2px solid transparent;
    border-radius: 6px;
    cursor: pointer;
    flex-shrink: 0;
    transition: border-color 0.3s;
}

.preview-thumbnail.active {
    border-color: #667eea;
}

.preview-thumbnail:hover {
    border-color: #5a6fd8;
}

.preview-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 4px;
}

.preview-nav {
    display: flex;
    justify-content: space-between;
    margin-top: 10px;
    padding: 0 10px;
}

.preview-nav button {
    background: #667eea;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.3s;
}

.preview-nav button:hover {
    background: #5a6fd8;
}

.preview-nav button:disabled {
    background: #ccc;
    cursor: not-allowed;
}

/* Preview Info Styles */
.preview-info {
    padding: 1rem;
    text-align: center;
    background: #f8f9fa;
    border-radius: 10px;
    margin-top: 1rem;
}

.preview-info h4 {
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
    color: #333;
}

.preview-info .price {
    font-size: 1.3rem;
    font-weight: bold;
    color: #667eea;
    margin-bottom: 0.5rem;
}

.preview-info .description {
    color: #666;
    line-height: 1.4;
    margin-bottom: 0;
}

/* Add to existing CSS */
.price-preview {
    font-weight: bold;
    color: #28a745;
    font-size: 16px;
    margin: 8px 0;
    text-align: center;
    padding: 8px;
    background: #f8f9fa;
    border-radius: 5px;
    border: 1px solid #e9ecef;
}

/* Image Preview Modal Styles */
.image-modal-content {
    max-width: 800px;
    max-height: 90vh;
}

/* Profile Picture Styles */
.profile-pic-container {
    text-align: center;
}

.profile-pic-preview {
    margin-bottom: 1rem;
}

.profile-preview-image {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    object-fit: cover;
    border: 4px solid #667eea;
    cursor: pointer;
    transition: all 0.3s;
}

.profile-preview-image:hover {
    border-color: #5a6fd8;
    transform: scale(1.05);
}

.form-control-file {
    width: 100%;
    padding: 0.5rem;
    border: 1px solid #ddd;
    border-radius: 5px;
    background: #f8f9fa;
}

.file-help {
    display: block;
    margin-top: 0.5rem;
    color: #666;
    font-size: 0.8rem;
}

/* Remove current profile picture button */
.btn-remove-pic {
    background: #dc3545;
    color: white;
    border: none;
    padding: 0.3rem 0.8rem;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.8rem;
    margin-top: 0.5rem;
}

.btn-remove-pic:hover {
    background: #c82333;
}

.auth-buttons {
    display: flex;
    gap: 1rem;
}

.btn {
    padding: 0.5rem 1.5rem;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    text-decoration: none;
    display: inline-block;
    transition: all 0.3s;
}

.btn-login {
    background: transparent;
    border: 2px solid white;
    color: white;
}

.btn-register {
    background: #ffd700;
    color: #333;
    font-weight: bold;
}

.btn:hover {
    transform: translateY(-2px);
}

/* Hero Section */
.hero {
    background: linear-gradient(
        rgba(102, 126, 234, 0.85), 
        rgba(118, 75, 162, 0.85)
    ), url('https://images.unsplash.com/photo-1558655146-9f40138edfeb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2064&q=80');
    background-size: cover;
    background-position: center;
    color: white;
    text-align: center;
    padding: 6rem 2rem;
    position: relative;
    overflow: hidden;
}

.hero::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, 
        rgba(255, 255, 255, 0.1) 0%,
        rgba(255, 255, 255, 0.05) 50%,
        rgba(255, 255, 255, 0.1) 100%);
    animation: shimmer 3s ease-in-out infinite;
}

@keyframes shimmer {
    0%, 100% { transform: translateX(-100%); }
    50% { transform: translateX(100%); }
}

.hero > *:not(.floating-elements) {
    position: relative;
    z-index: 2;
}

.hero h1 {
    font-size: 3.5rem;
    margin-bottom: 1rem;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
}

.hero p {
    font-size: 1.2rem;
    margin-bottom: 2rem;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
}

/* Add this to your CSS */
.btn-cart.added {
    background: #dc3545 !important; /* Red color for remove */
}

.btn-cart.added:hover {
    background: #c82333 !important; /* Darker red on hover */
}

.btn-wishlist.added {
    background: #6c757d !important; /* Gray color for remove */
}

.btn-wishlist.added:hover {
    background: #5a6268 !important; /* Darker gray on hover */
}

/* Hero Buttons */
.hero-buttons {
    display: flex;
    gap: 1rem;
    justify-content: center;
    flex-wrap: wrap;
    margin-top: 1.5rem;
}

.btn-hero, .btn-custom {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 50px;
    color: white;
    font-weight: 600;
    letter-spacing: 0.5px;
    position: relative;
    overflow: hidden;
    transition: all 0.4s ease;
    padding: 1rem 2rem;
    font-size: 1.1rem;
    font-weight: bold;
    text-decoration: none;
    display: inline-block;
    cursor: pointer;
}

.btn-hero::before, .btn-custom::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.4),
        transparent
    );
    transition: left 0.5s;
}

.btn-hero:hover::before, .btn-custom:hover::before {
    left: 100%;
}

.btn-hero:hover, .btn-custom:hover {
    background: rgba(255, 255, 255, 0.25);
    transform: translateY(-3px);
    box-shadow: 
        0 10px 25px rgba(0, 0, 0, 0.2),
        0 0 30px rgba(255, 255, 255, 0.1);
}

.btn-custom {
    background: #25D366; /* WhatsApp green */
}

.btn-custom:hover {
    background: #128C7E; /* Darker WhatsApp green */
}

/* Designs Section */
.designs-section {
    padding: 4rem 2rem;
    max-width: 1200px;
    margin: 0 auto;
    text-align: center;
}

/* Section Header for proper centering */
.section-header {
    text-align: center;
    width: 100%;
    margin-bottom: 3rem;
    display: flex;
    justify-content: center;
}

/* Centered Glass Section Title */
.section-title {
    position: relative;
    display: inline-block;
    text-align: center;
    margin: 0 auto;
    padding: 1rem 2rem;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 50px;
    box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    font-size: 2.5rem;
    color: #333;
}

.section-title::after {
    content: '';
    position: absolute;
    bottom: -15px;
    left: 50%;
    transform: translateX(-50%);
    width: 80px;
    height: 3px;
    background: linear-gradient(45deg, #667eea, #764ba2);
    border-radius: 3px;
    animation: titleUnderline 2s ease-in-out infinite;
}

@keyframes titleUnderline {
    0%, 100% { width: 100px; }
    50% { width: 150px; }
}

/* Enhanced disabled states for login required */
.btn-cart.disabled-login, .btn-wishlist.disabled-login {
    background: #6c757d !important;
    cursor: not-allowed;
    opacity: 0.7;
    transform: none !important;
}

.btn-cart.disabled-login:hover, .btn-wishlist.disabled-login:hover {
    opacity: 0.7;
    transform: none !important;
}

.login-required-message {
    text-align: center;
    margin-top: 1rem;
    padding: 1rem;
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    border-radius: 5px;
}

.login-required-message p {
    color: #856404;
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
}

/* Profile completion required states */
.btn-cart.disabled-profile, .btn-wishlist.disabled-profile {
    background: #ffc107 !important;
    color: #212529 !important;
    cursor: not-allowed;
    opacity: 0.9;
    transform: none !important;
}

.btn-cart.disabled-profile:hover, .btn-wishlist.disabled-profile:hover {
    opacity: 0.9;
    transform: none !important;
    background: #ffc107 !important;
}

.profile-required-message {
    text-align: center;
    margin-top: 1rem;
    padding: 1rem;
    background: #d1ecf1;
    border: 1px solid #bee5eb;
    border-radius: 5px;
}

.profile-required-message p {
    color: #0c5460;
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
}

.btn-profile-small {
    background: #17a2b8;
    color: white;
    padding: 0.4rem 1rem;
    border-radius: 4px;
    text-decoration: none;
    font-size: 0.8rem;
    font-weight: bold;
    border: none;
    cursor: pointer;
}

.btn-profile-small:hover {
    background: #138496;
}

.btn-login-small {
    background: #667eea;
    color: white;
    padding: 0.4rem 1rem;
    border-radius: 4px;
    text-decoration: none;
    font-size: 0.8rem;
    font-weight: bold;
    display: inline-block;
}

.btn-login-small:hover {
    background: #5a6fd8;
}

/* Tooltip styles for better UX */
[title] {
    position: relative;
}

[title]:hover::after {
    content: attr(title);
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: #333;
    color: white;
    padding: 0.5rem;
    border-radius: 4px;
    font-size: 0.8rem;
    white-space: nowrap;
    z-index: 1000;
    margin-bottom: 5px;
}

[title]:hover::before {
    content: '';
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 5px solid transparent;
    border-top-color: #333;
    margin-bottom: -5px;
}

/* Enhanced Color Dropdown Styles */
.color-dropdown option {
    padding: 10px 15px;
    font-size: 14px;
    font-weight: 500;
}

.color-dropdown {
    font-size: 14px;
    padding: 10px 15px;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 10px;
    transition: all 0.3s ease;
}

.color-dropdown:focus {
    background: rgba(255, 255, 255, 0.15);
    border-color: rgba(102, 126, 234, 0.5);
    box-shadow: 0 0 15px rgba(102, 126, 234, 0.2);
}

/* Style the dropdown arrow */
.color-dropdown {
    background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23333' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right 15px center;
    background-size: 16px;
    padding-right: 40px;
}

.designs-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    margin-bottom: 3rem;
}

/* Enhanced Design Cards with Glass Effect */
.design-card {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 15px;
    box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    position: relative;
    overflow: hidden;
    cursor: pointer;
}

.design-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.1),
        transparent
    );
    transition: left 0.5s;
}

.design-card:hover::before {
    left: 100%;
}

.design-card:hover {
    transform: translateY(-10px) scale(1.02);
    box-shadow: 
        0 20px 40px rgba(0, 0, 0, 0.15),
        0 0 80px rgba(102, 126, 234, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

/* Enhanced Image Hover Effects */
.design-image {
    width: 100%;
    height: 200px;
    object-fit: cover;
    cursor: pointer;
    transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    filter: brightness(0.95);
}

.design-image:hover {
    filter: brightness(1.05) contrast(1.1);
    transform: scale(1.05) rotate(1deg);
}

.design-info {
    padding: 1.5rem;
}

.design-name {
    font-size: 1.3rem;
    font-weight: bold;
    margin-bottom: 0.5rem;
    color: #333;
}

.design-category {
    color: #666;
    font-size: 0.9rem;
    margin-bottom: 1rem;
}

.design-price {
    font-size: 1.5rem;
    font-weight: bold;
    color: #667eea;
    margin-bottom: 1rem;
}

.design-description {
    color: #666;
    margin-bottom: 1.5rem;
    line-height: 1.4;
}

.design-actions {
    display: flex;
    gap: 0.5rem;
}

.btn-cart, .btn-wishlist {
    flex: 1;
    padding: 0.7rem;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s;
    font-weight: bold;
}

.btn-cart {
    background: #667eea;
    color: white;
}

.btn-wishlist {
    background: #ff6b6b;
    color: white;
}

/* Enhanced button states */
.btn-cart.added {
    background: #dc3545 !important;
}

.btn-wishlist.added {
    background: #6c757d !important;
}

.btn-cart:hover {
    opacity: 0.9;
    transform: translateY(-2px);
}

.btn-wishlist:hover {
    opacity: 0.9;
    transform: translateY(-2px);
}

.btn-cart:disabled, .btn-wishlist:disabled {
    background: #ccc !important;
    cursor: not-allowed;
    transform: none !important;
}

/* Loading and Error States */
.loading {
    text-align: center;
    padding: 3rem;
    color: #666;
    font-size: 1.1rem;
    position: relative;
}

.loading::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 50px;
    height: 3px;
    background: linear-gradient(45deg, #667eea, #764ba2);
    border-radius: 3px;
    animation: loadingBar 1.5s ease-in-out infinite;
}

@keyframes loadingBar {
    0%, 100% { width: 50px; opacity: 0.7; }
    50% { width: 100px; opacity: 1; }
}

.error {
    text-align: center;
    padding: 2rem;
    background: #ff6b6b;
    color: white;
    border-radius: 10px;
    margin: 2rem 0;
}

.retry-btn {
    background: white;
    color: #ff6b6b;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 1rem;
    font-weight: bold;
}

/* Footer */
footer {
    background: #333;
    color: white;
    text-align: center;
    padding: 2rem;
    margin-top: 4rem;
}

/* User Info */
.user-info {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    color: white;
    flex-wrap: wrap;
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #ffd700;
}

.user-name {
    font-weight: bold;
}

.logout-btn {
    background: #ff6b6b;
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.9rem;
}

/* Cart and Wishlist Badges */
.cart-badge, .wishlist-badge {
    position: relative;
}

.badge {
    position: absolute;
    top: -8px;
    right: -8px;
    background: #ff6b6b;
    color: white;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    font-size: 0.8rem;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Profile Modal Styles */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 1000;
    justify-content: center;
    align-items: center;
}

/* Enhanced Modal Glass Effects */
.modal-content {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 
        0 25px 50px rgba(0, 0, 0, 0.25),
        inset 0 1px 0 rgba(255, 255, 255, 0.6);
    border-radius: 20px;
    padding: 2rem;
    width: 90%;
    max-width: 500px;
    max-height: 90vh;
    overflow-y: auto;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid #f8f9fa;
}

.modal-header h3 {
    color: #333;
    margin: 0;
}

.close-btn {
    background: none;
    border: none;
    font-size: 1.5rem;
    cursor: pointer;
    color: #666;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.close-btn:hover {
    color: #333;
    background: #f8f9fa;
    border-radius: 50%;
}

.form-group {
    margin-bottom: 1.5rem;
}

.form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: bold;
    color: #333;
}

.form-control {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #ddd;
    border-radius: 5px;
    font-size: 1rem;
    transition: border-color 0.3s;
}

.form-control:focus {
    outline: none;
    border-color: #667eea;
}

.form-actions {
    display: flex;
    gap: 1rem;
    justify-content: flex-end;
    margin-top: 2rem;
}

.btn-cancel {
    background: #6c757d;
    color: white;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
}

.btn-save {
    background: #28a745;
    color: white;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
}

.btn-cancel:hover {
    background: #5a6268;
}

.btn-save:hover {
    background: #218838;
}

.btn-profile {
    background: #17a2b8;
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.9rem;
}
.cart-profile {
    background: #0077ff;
    color: rgb(255, 255, 255);
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.9rem;
}
.btn-profile:hover {
    background: #138496;
}

/* Responsive modal */
@media (max-width: 768px) {
    .modal-content {
        width: 95%;
        margin: 1rem;
        padding: 1.5rem;
    }
    
    .form-actions {
        flex-direction: column;
    }
    
    .btn-cancel, .btn-save {
        width: 100%;
    }
}

/* Search Section Styles */
.search-section {
    max-width: 600px;
    margin: 0 auto 3rem auto;
    padding: 0 1rem;
}

.search-box {
    position: relative;
    display: flex;
    align-items: center;
}

/* Enhanced Search Box */
.search-input {
    width: 100%;
    padding: 0.8rem 3rem 0.8rem 1rem;
    background: rgba(0, 0, 0, 0.3) !important;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 25px;
    font-size: 1rem;
    outline: none;
    transition: all 0.3s;
    color: white !important;
    font-weight: 500;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.search-input::placeholder {
    color: rgba(255, 255, 255, 0.8) !important;
    font-weight: 400;
}

.search-input:focus {
    background: rgba(0, 0, 0, 0.4) !important;
    border-color: rgba(102, 126, 234, 0.8);
    box-shadow: 
        0 0 25px rgba(102, 126, 234, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    color: white !important;
}

.search-icon {
    position: absolute;
    right: 1rem;
    color: #667eea;
    font-size: 1.2rem;
    pointer-events: none;
}

/* Search Results Info */
.search-results-info {
    text-align: center;
    padding: 1rem;
    background: #e9ecef;
    border-radius: 10px;
    margin-bottom: 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.btn-clear-search {
    background: #6c757d;
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 5px;
    cursor: pointer;
    font-size: 0.9rem;
}

.btn-clear-search:hover {
    background: #5a6268;
}

/* Customization Modal Styles */
.customization-form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.customization-form-grid .form-group {
    margin-bottom: 0;
}

.size-inputs {
    display: flex;
    gap: 0.5rem;
    align-items: center;
}

.size-inputs .form-control {
    flex: 1;
}

.size-unit {
    color: #666;
    font-size: 0.9rem;
    white-space: nowrap;
}

.customization-preview {
    text-align: center;
    padding: 1rem;
    background: #f8f9fa;
    border-radius: 8px;
    margin-bottom: 1rem;
    border: 1px solid #e9ecef;
}

.customization-preview h4 {
    margin-bottom: 0.5rem;
    color: #333;
}

.customization-preview p {
    margin: 0.2rem 0;
    color: #666;
    font-size: 0.9rem;
}

.customization-required {
    color: #dc3545;
    margin-left: 2px;
}

/* NEW: Customization Options Grid */
.customization-options-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.option-group {
    margin-bottom: 1rem;
}

.option-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: bold;
    color: #333;
}

.radio-group {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.radio-option {
    display: flex;
    align-items: center;
    gap: 0.3rem;
}

.size-options {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.size-option {
    padding: 0.5rem 1rem;
    border: 2px solid #ddd;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s;
    background: white;
}

.size-option.selected {
    border-color: #667eea;
    background: #667eea;
    color: white;
}

/* Floating Animation */
@keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
}

.floating {
    animation: float 3s ease-in-out infinite;
}

/* Pulse Animation */
@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}

.pulse {
    animation: pulse 2s ease-in-out infinite;
}

/* Gradient Text Animation */
.gradient-text {
    background: linear-gradient(45deg, #667eea, #764ba2, #ffd700, #667eea);
    background-size: 300% 300%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: gradientShift 3s ease infinite;
}

@keyframes gradientShift {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}

/* Floating Elements */
.floating-elements {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    pointer-events: none;
    z-index: 1;
}

.floating-element {
    position: absolute;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 50%;
    animation: floatRandom 6s ease-in-out infinite;
}

@keyframes floatRandom {
    0%, 100% { 
        transform: translate(0, 0) rotate(0deg); 
    }
    25% { 
        transform: translate(10px, -15px) rotate(90deg); 
    }
    50% { 
        transform: translate(-5px, -25px) rotate(180deg); 
    }
    75% { 
        transform: translate(15px, -10px) rotate(270deg); 
    }
}

/* Custom Scrollbar */
::-webkit-scrollbar {
    width: 8px;
}

::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
}

::-webkit-scrollbar-thumb {
    background: linear-gradient(45deg, #667eea, #764ba2);
    border-radius: 10px;
}

::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(45deg, #764ba2, #667eea);
}

/* ========== MOBILE RESPONSIVE STYLES ========== */
/* ========== EXTRA SMALL SCREEN FIXES (320px and below) ========== */
@media (max-width: 320px) {
    /* Header adjustments */
    .nav-container {
        padding: 0 10px !important;
    }
    
    .logo {
        font-size: 1.1rem !important;
    }
    
    /* Hero section fixes */
    .hero {
        padding: 3rem 1rem !important;
    }
    
    .hero h1 {
        font-size: 1.8rem !important;
        line-height: 1.2;
    }
    
    .hero p {
        font-size: 0.9rem !important;
        padding: 0 5px;
    }
    
    .hero-buttons {
        flex-direction: column;
        gap: 0.8rem;
    }
    
    .btn-hero, .btn-custom {
        padding: 0.8rem 1.2rem !important;
        font-size: 0.9rem !important;
        width: 100%;
        max-width: 250px;
        margin: 0 auto;
    }
    
    /* Designs section */
    .designs-section {
        padding: 2rem 0.5rem !important;
    }
    
    .section-title {
        font-size: 1.5rem !important;
        padding: 0.8rem 1.2rem !important;
    }
    
    /* Search box */
    .search-section {
        padding: 0 0.5rem;
        margin-bottom: 2rem;
    }
    
    .search-input {
        font-size: 0.9rem !important;
        padding: 0.7rem 2.5rem 0.7rem 0.8rem !important;
    }
    
    .search-icon {
        right: 0.8rem;
        font-size: 1rem;
    }
    
    /* Design cards */
    .designs-grid {
        grid-template-columns: 1fr !important;
        gap: 1.5rem;
    }
    
    .design-card {
        margin: 0 5px;
    }
    
    .design-info {
        padding: 1rem !important;
    }
    
    .design-name {
        font-size: 1.1rem !important;
    }
    
    .design-price {
        font-size: 1.2rem !important;
    }
    
    .design-actions {
        flex-direction: column;
        gap: 0.5rem;
    }
    
    .btn-cart, .btn-wishlist {
        width: 100%;
        padding: 0.8rem !important;
        font-size: 0.85rem !important;
    }
    
    /* Profile dropdown */
    .profile-dropdown-menu {
        min-width: 180px;
        right: -10px;
    }
    
    /* Modal fixes */
    .modal-content {
        width: 95% !important;
        margin: 0.5rem !important;
        padding: 1rem !important;
    }
    
    /* Customization modal specific fixes */
    .customization-options-grid {
        grid-template-columns: 1fr !important;
        gap: 0.8rem;
    }
    
    .size-options {
        justify-content: space-between;
    }
    
    .size-option {
        padding: 0.4rem 0.8rem;
        font-size: 0.8rem;
        flex: 1;
        text-align: center;
        min-width: 40px;
    }
    
    /* Image preview modal */
    .preview-image {
        max-height: 300px !important;
    }
    
    .preview-thumbnail {
        width: 50px !important;
        height: 50px !important;
    }
    
    .preview-nav {
        flex-direction: column;
        gap: 0.5rem;
    }
    
    .preview-nav button {
        width: 100%;
    }
    
    /* Form elements */
    .form-control {
        font-size: 13px !important;
        padding: 0.7rem !important;
    }
    
    /* Mobile menu */
    #mobileNav {
        width: 90% !important;
    }
    
    #mobileNav ul li a {
        padding: 0.8rem !important;
        font-size: 1rem !important;
    }
    
    /* Auth buttons in header */
    .auth-buttons {
        gap: 0.5rem;
    }
    
    .btn-login, .btn-register {
        padding: 0.5rem 0.8rem !important;
        font-size: 0.8rem !important;
    }
    
    /* User info in header */
    .user-info {
        gap: 0.5rem;
    }
    
    .user-avatar {
        width: 32px !important;
        height: 32px !important;
    }
    
    .user-name {
        font-size: 0.8rem;
    }
    
    /* Badges */
    .badge {
        width: 16px !important;
        height: 16px !important;
        font-size: 0.7rem !important;
        top: -6px !important;
        right: -6px !important;
    }
    
    /* Footer */
    footer {
        padding: 1.5rem 1rem !important;
        font-size: 0.8rem;
    }
    
    /* Ensure no horizontal scrolling */
    body {
        overflow-x: hidden;
        width: 100%;
    }
    
    /* Fix for any potential overflow issues */
    * {
        max-width: 100%;
    }
}

/* Additional touch optimizations for very small screens */
@media (max-width: 320px) and (hover: none) and (pointer: coarse) {
    .btn, button, a, input, select, textarea {
        min-height: 44px;
        font-size: 16px; /* Prevents zoom on iOS */
    }
    
    input, select, textarea {
        font-size: 16px !important; /* Prevents zoom on iOS */
    }
}
/* ========== 375px SPECIFIC FIXES ========== */
@media (min-width: 321px) and (max-width: 375px) {
    /* Center the designs grid */
    .designs-section {
        padding: 2rem 0.8rem !important;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    
    .designs-grid {
        grid-template-columns: 1fr !important;
        gap: 1.5rem;
        width: 100%;
        max-width: 340px;
        margin: 0 auto;
        justify-items: center;
    }
    
    .design-card {
        width: 100%;
        max-width: 320px;
        margin: 0 auto;
    }
    
    /* Center section header */
    .section-header {
        width: 100%;
        display: flex;
        justify-content: center;
    }
    
    .section-title {
        text-align: center;
        margin: 0 auto;
    }
    
    /* Center search section */
    .search-section {
        width: 100%;
        max-width: 340px;
        margin: 0 auto 2rem auto;
        padding: 0 0.5rem;
    }
    
    /* Ensure proper centering of all content */
    .designs-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
    }
    
    /* Fix for design actions buttons */
    .design-actions {
        display: flex;
        gap: 0.8rem;
    }
    
    .btn-cart, .btn-wishlist {
        flex: 1;
        min-width: 0; /* Allow buttons to shrink properly */
    }
    
    /* Hero section adjustments */
    .hero {
        padding: 4rem 1rem !important;
    }
    
    .hero h1 {
        font-size: 2rem !important;
    }
    
    .hero p {
        font-size: 1rem !important;
        max-width: 320px;
        margin-left: auto;
        margin-right: auto;
    }
    
    .hero-buttons {
        justify-content: center;
        flex-wrap: wrap;
    }
    
    .btn-hero, .btn-custom {
        min-width: 160px;
    }
}

/* Additional general mobile fixes that might affect 375px */
@media (max-width: 375px) {
    /* Ensure body content is properly centered */
    body {
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    
    /* Main content wrapper */
    .designs-section {
        width: 100%;
    }
    
    /* Fix any potential margin/padding issues */
    .container, section {
        padding-left: 0.8rem !important;
        padding-right: 0.8rem !important;
    }
    
    /* Center the loading and error states */
    .loading, .error {
        text-align: center;
        margin-left: auto;
        margin-right: auto;
    }
}
/* Mobile Menu Styles - Only for mobile */
@media (max-width: 768px) {
    .mobile-menu-toggle {
        display: block;
        background: none;
        border: none;
        color: white;
        font-size: 1.5rem;
        cursor: pointer;
        padding: 0.5rem;
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        z-index: 1001;
    }

    #mobileNav {
        position: fixed;
        top: 0;
        left: -100%;
        width: 80%;
        max-width: 300px;
        height: 100vh;
        background: linear-gradient(135deg, 
            rgba(102, 126, 234, 0.95) 0%, 
            rgba(118, 75, 162, 0.95) 100%);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        z-index: 1000;
        transition: left 0.3s ease-in-out;
        padding: 4rem 1rem 1rem;
        box-shadow: 2px 0 10px rgba(0,0,0,0.2);
        overflow-y: auto;
    }

    #mobileNav.show {
        left: 0;
    }

    #mobileNav ul {
        flex-direction: column;
        gap: 0.5rem;
        width: 100%;
    }

    #mobileNav ul li {
        width: 100%;
    }

    #mobileNav ul li a {
        display: block;
        padding: 1rem;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        text-align: left;
        font-size: 1.1rem;
        transition: all 0.3s;
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    #mobileNav ul li a:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: translateX(5px);
    }

    /* Overlay when mobile menu is open */
    .mobile-nav-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
        display: none;
    }

    .mobile-nav-overlay.show {
        display: block;
    }

    /* Adjust header for mobile */
    .nav-container {
        position: relative;
        padding-left: 50px !important; /* Make space for hamburger icon */
    }
    
    .logo {
        margin-left: auto;
        margin-right: auto;
    }
    
    /* Hide the original navigation on mobile */
    nav:not(#mobileNav) {
        display: none;
    }
    
    .auth-buttons {
        margin-left: auto;
    }

    /* Mobile responsive adjustments */
    .nav-container { flex-wrap: wrap; padding: 0 15px !important; }
    .logo { font-size: 1.4rem !important; }
    .container, section { padding: 1.5rem 15px !important; }
    .modal-content { width: 95% !important; max-width: 95% !important; margin: 1rem auto !important; padding: 1.5rem !important; }
    .form-control { font-size: 14px !important; }
    .btn { padding: 0.7rem 1.5rem !important; font-size: 0.9rem !important; }
    table { font-size: 0.85rem !important; }
    th, td { padding: 0.5rem !important; }
    h1 { font-size: 1.8rem !important; }
    h2 { font-size: 1.5rem !important; }
    h3 { font-size: 1.2rem !important; }
}

/* For very small screens */
@media (max-width: 480px) {
    #mobileNav {
        width: 85%;
    }
    
    .logo { font-size: 1.2rem !important; }
    h1 { font-size: 1.5rem !important; }
    h2 { font-size: 1.3rem !important; }
    .btn { padding: 0.6rem 1.2rem !important; font-size: 0.85rem !important; }
    .form-control { font-size: 13px !important; padding: 0.6rem !important; }
    .modal-content { padding: 1rem !important; }
    table { font-size: 0.75rem !important; }
}

/* PC Styles - Keep original navigation */
@media (min-width: 769px) {
    .mobile-menu-toggle {
        display: none !important;
    }
    
    #mobileNav {
        display: none !important;
    }
    
    .mobile-nav-overlay {
        display: none !important;
    }
    
    /* Restore original PC navigation */
    nav {
        display: flex !important;
    }
    
    nav ul {
        list-style: none;
        display: flex;
        gap: 2rem;
    }

    nav a {
        color: white;
        text-decoration: none;
        transition: color 0.3s;
    }

    nav a:hover {
        color: #ffd700;
    }
    
    .nav-container {
        padding-left: 20px !important; /* Reset padding for PC */
    }
}

/* Touch device optimizations */
@media (hover: none) and (pointer: coarse) {
    .btn, button, a, input, select, textarea { min-height: 44px; }
}
/* When the mobile nav is open, make profile appear below it (like cart/wishlist) */
.mobile-menu-open .profile-dropdown,
.mobile-menu-open .profile-dropdown-menu {
    z-index: 900 !important;        /* lower than #mobileNav (1000) */
    pointer-events: none;           /* prevent clicks on profile while menu open */
    opacity: 0.98;                  /* optional: slightly dim so it's visually under */
}

/* Re-enable interaction when menu closed */
.profile-dropdown,
.profile-dropdown-menu {
    pointer-events: auto;
}

    </style>
</head>
<body>
    <!-- Header -->
    <!-- Header -->
<header>
    <div class="nav-container">
        <div class="logo">Fine<span>Graphics</span></div>
        
        <!-- Mobile Hamburger Menu -->
        <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle menu">‚ò∞</button>
        
        <!-- Mobile Navigation (hidden on PC) -->
        <nav id="mobileNav">
            <ul>
                <li><a href="#home">Home</a></li>
                <li><a href="#designs">Designs</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="orders.html">My Orders</a></li>
            </ul>
        </nav>
        
        <!-- Original PC Navigation (hidden on mobile) -->
        <nav>
            <ul>
                <li><a href="#home">Home</a></li>
                <li><a href="#designs">Designs</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="orders.html">My Orders</a></li>
            </ul>
        </nav>
        
        <div class="auth-buttons" id="authButtons">
            <!-- Will be populated by JavaScript -->
        </div>
    </div>
</header>

    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="floating-elements">
            <div class="floating-element" style="width: 100px; height: 100px; top: 10%; left: 10%;"></div>
            <div class="floating-element" style="width: 150px; height: 150px; top: 60%; right: 10%;"></div>
            <div class="floating-element" style="width: 80px; height: 80px; bottom: 20%; left: 20%;"></div>
        </div>
        <h1 class="gradient-text floating">Premium Graphic Design Services</h1>
        <p>Transform your ideas into stunning visual designs with our professional graphic design services.</p>
        <div class="hero-buttons">
            <a href="#designs" class="btn btn-hero pulse">Explore Designs</a>
            <a href="https://wa.me/9843765564?text=Hi%20Fine%20Graphics!%20I%20want%20to%20create%20my%20own%20custom%20design.%20Please%20guide%20me%20through%20the%20process." 
               class="btn-custom pulse" target="_blank">
               üé® Get Your Own Design
            </a>
        </div>
    </section>

    <!-- Designs Section -->
    <section class="designs-section" id="designs">
        <div class="section-header">
            <h2 class="section-title floating">Our Design Collection</h2>
        </div>
        
        <!-- Search Container -->
        <div class="search-section">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search designs by name, category, or description..." 
                       class="search-input" oninput="performSearch()">
                <span class="search-icon">üîç</span>
            </div>
        </div>
        
        <div id="designsContainer" class="loading">
            <div class="floating">Loading designs...</div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <p>&copy; 2024 Fine Graphics. All rights reserved.</p>
        <p>Professional Graphic Design Services</p>
    </footer>

    <script>
        // Global variables
        let currentUser = null;
        let cart = [];
        let wishlist = [];
        let designs = []; // Added for image preview
        let currentCustomizationDesign = null; // Store design being customized

        // Initialize the application
        async function initApp() {
            await checkLoginStatus();
            
            // Load from localStorage FIRST
            loadCartFromStorage();
            loadWishlistFromStorage();
            
            // THEN sync with database (which now preserves local data)
            await syncUserData();
            
            await loadDesigns();
            updateAuthButtons();
            updateCartBadges();
            
            console.log(`üéØ App initialized - Cart: ${cart.length}, Wishlist: ${wishlist.length}`);
        }

        // Profile Picture Variables
        let profilePicBase64 = "";
        let currentProfilePicFile = null;

        // Preview profile image
        function previewProfileImage(input) {
            const file = input.files[0];
            const preview = document.getElementById('profilePicPreview');
            
            if (file) {
                // Validate file type
                if (!file.type.startsWith('image/')) {
                    showNotification('Please select an image file (JPG, PNG, etc.)', 'remove');
                    input.value = '';
                    return;
                }
                
                // Validate file size (max 2MB)
                if (file.size > 2 * 1024 * 1024) {
                    showNotification('Image size should be less than 2MB', 'remove');
                    input.value = '';
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    profilePicBase64 = e.target.result; // This is the base64 data URL
                    preview.src = profilePicBase64;
                    
                    // Show remove button
                    showRemoveProfilePicButton();
                };
                reader.readAsDataURL(file);
            } else {
                profilePicBase64 = "";
                // Reset to current user's profile pic or default
                preview.src = currentUser?.profile_pic || 'https://via.placeholder.com/150?text=No+Image';
                hideRemoveProfilePicButton();
            }
        }

        // Show remove profile picture button
        function showRemoveProfilePicButton() {
            let removeBtn = document.querySelector('.btn-remove-pic');
            if (!removeBtn) {
                removeBtn = document.createElement('button');
                removeBtn.type = 'button';
                removeBtn.className = 'btn-remove-pic';
                removeBtn.textContent = 'üóëÔ∏è Remove Photo';
                removeBtn.onclick = removeProfilePicture;
                document.querySelector('.profile-pic-container').appendChild(removeBtn);
            }
        }

        // Hide remove profile picture button
        function hideRemoveProfilePicButton() {
            const removeBtn = document.querySelector('.btn-remove-pic');
            if (removeBtn) {
                removeBtn.remove();
            }
        }

        // Remove profile picture
        function removeProfilePicture() {
            const input = document.getElementById('profilePicInput');
            const preview = document.getElementById('profilePicPreview');
            
            input.value = '';
            profilePicBase64 = "";
            
            // Set to default avatar
            preview.src = 'https://via.placeholder.com/150?text=No+Image';
            
            hideRemoveProfilePicButton();
            showNotification('Profile picture removed', 'remove');
        }

        // Check if user is logged in
        async function checkLoginStatus() {
            const userData = localStorage.getItem('currentUser');
            if (userData) {
                currentUser = JSON.parse(userData);
                console.log('User logged in:', currentUser.username);
            }
        }

        // Sync user data when page loads
        async function syncUserData() {
            if (!currentUser) return;

            try {
                // Get latest data from database
                const response = await fetch(`/getUserData/${currentUser.username}`);
                const result = await response.json();

                if (result.success) {
                    console.log(`üîÑ Syncing data - Database Cart: ${result.cart?.length || 0}, Database Wishlist: ${result.wishlist?.length || 0}`);
                    console.log(`üîÑ Local data - Local Cart: ${cart.length}, Local Wishlist: ${wishlist.length}`);
                    
                    // Only update cart if database has cart items AND local cart is empty
                    // This prevents empty database cart from overwriting local cart
                    if (result.cart && result.cart.length > 0) {
                        cart = result.cart;
                        console.log('‚úÖ Cart updated from database');
                    } else if (cart.length === 0 && result.cart && result.cart.length === 0) {
                        // Both are empty, no action needed
                        console.log('‚ÑπÔ∏è Both local and database carts are empty');
                    } else if (cart.length > 0 && (!result.cart || result.cart.length === 0)) {
                        // Local has items but database is empty - SYNC LOCAL TO DATABASE
                        console.log('üîÑ Local cart has items, syncing to database...');
                        await syncCartToDatabase();
                    }
                    
                    // Same logic for wishlist
                    if (result.wishlist && result.wishlist.length > 0) {
                        wishlist = result.wishlist;
                        console.log('‚úÖ Wishlist updated from database');
                    } else if (wishlist.length === 0 && result.wishlist && result.wishlist.length === 0) {
                        console.log('‚ÑπÔ∏è Both local and database wishlists are empty');
                    } else if (wishlist.length > 0 && (!result.wishlist || result.wishlist.length === 0)) {
                        console.log('üîÑ Local wishlist has items, syncing to database...');
                        await syncWishlistToDatabase();
                    }

                    saveCartToStorage();
                    saveWishlistToStorage();
                    updateCartBadges();
                    console.log(`‚úÖ Sync complete - Cart: ${cart.length}, Wishlist: ${wishlist.length}`);
                }
            } catch (error) {
                console.error('Error syncing user data:', error);
            }
        }

        // Load designs from database
        async function loadDesigns() {
            const container = document.getElementById('designsContainer');
            
            try {
                container.innerHTML = '<div class="loading">Loading designs from database...</div>';
                
                const response = await fetch('/getDesigns');
                const result = await response.json();

                if (result.success) {
                    designs = result.designs || [];
                    
                    if (designs.length === 0) {
                        container.innerHTML = `
                            <div class="error">
                                <h3>No Designs Available</h3>
                                <p>No designs have been added to the catalog yet.</p>
                                <p>Please check back later or contact the administrator.</p>
                            </div>
                        `;
                        return;
                    }

                    renderDesigns(designs);
                } else {
                    throw new Error(result.message || 'Failed to load designs');
                }
            } catch (error) {
                console.error('Error loading designs:', error);
                container.innerHTML = `
                    <div class="error">
                        <h3>Failed to Load Designs</h3>
                        <p>${error.message}</p>
                        <button class="retry-btn" onclick="loadDesigns()">Retry</button>
                    </div>
                `;
            }
        }

        // Check if user profile is complete
        function isProfileComplete() {
            if (!currentUser) return false;
            
            return currentUser.address && 
                   currentUser.mobile && 
                   currentUser.district &&
                   currentUser.address.trim() !== '' &&
                   currentUser.mobile.trim() !== '' &&
                   currentUser.district.trim() !== '';
        }

        // Show profile completion required message
        function showProfileRequired() {
            showNotification('üìù Please complete your profile first', 'remove');
            
            // Auto-open profile modal after 1 second
            setTimeout(() => {
                if (confirm('You need to complete your profile before shopping. Complete it now?')) {
                    openUpdateProfileModal();
                }
            }, 1000);
        }

        // Render designs to the page - UPDATED with profile completion check AND image preview
        function renderDesigns(designsArray) {
            const container = document.getElementById('designsContainer');
            
            if (designsArray.length === 0) {
                container.innerHTML = '<div class="loading">No designs found.</div>';
                return;
            }

            let designsHTML = '<div class="designs-grid">';

            designsArray.forEach(design => {
                const imageSrc = design.image_data ? 
                    `data:${design.image_type};base64,${design.image_data}` : 
                    'https://via.placeholder.com/300x200?text=No+Image';
                
                const isInCart = cart.some(item => item.name === design.name);
                const isInWishlist = wishlist.some(item => item.name === design.name);
                
                // Check conditions for button states
                const isLoggedIn = !!currentUser;
                const hasCompleteProfile = isProfileComplete();
                const canAddToCart = isLoggedIn && hasCompleteProfile;
                const canAddToWishlist = isLoggedIn && hasCompleteProfile;

                let cartButtonText, wishlistButtonText, cartButtonClass, wishlistButtonClass, cartOnClick, wishlistOnClick;

                if (!isLoggedIn) {
                    cartButtonText = 'üîí Login for Cart';
                    wishlistButtonText = 'üîí Login for Wishlist';
                    cartButtonClass = 'disabled-login';
                    wishlistButtonClass = 'disabled-login';
                    cartOnClick = 'showLoginRequired()';
                    wishlistOnClick = 'showLoginRequired()';
                } else if (!hasCompleteProfile) {
                    cartButtonText = 'üìù Complete Profile';
                    wishlistButtonText = 'üìù Complete Profile';
                    cartButtonClass = 'disabled-profile';
                    wishlistButtonClass = 'disabled-profile';
                    cartOnClick = 'showProfileRequired()';
                    wishlistOnClick = 'showProfileRequired()';
                } else {
                    // FIX: Different behavior for Add vs Remove
                    if (isInCart) {
                        // Item is already in cart - show remove button
                        cartButtonText = 'üóëÔ∏è Remove from Cart';
                        cartButtonClass = 'added';
                        cartOnClick = `removeFromCart('${design.name}')`; // Direct remove function
                    } else {
                        // Item not in cart - show add button with customization
                        cartButtonText = 'üõí Add to Cart';
                        cartButtonClass = '';
                        cartOnClick = `openCustomizationModal('${design.name}', ${design.price}, '${imageSrc}', ${design.id})`;
                    }
                    
                    // Wishlist logic remains the same
                    wishlistButtonText = isInWishlist ? 'üíî Remove from Wishlist' : '‚ù§Ô∏è Add to Wishlist';
                    wishlistButtonClass = isInWishlist ? 'added' : '';
                    wishlistOnClick = `addToWishlist('${design.name}', ${design.price}, '${imageSrc}')`;
                }

                // Create a safe design object for the preview function
                const safeDesign = {
                    id: design.id,
                    name: design.name.replace(/'/g, "\\'"),
                    price: design.price,
                    description: (design.description || 'No description available.').replace(/'/g, "\\'"),
                    image_data: design.image_data || '',
                    image_type: design.image_type || ''
                };

                designsHTML += `
                    <div class="design-card" data-design-id="${design.id}">
                        <img src="${imageSrc}" 
                             alt="${design.name}" 
                             class="design-image" 
                             onclick="openImagePreview('${encodeURIComponent(JSON.stringify(safeDesign))}')">
                        <div class="design-info">
                            <div class="design-name">${design.name}</div>
                            <div class="design-category">${design.category || 'General'}</div>
                            <div class="design-description">${design.description || 'No description available.'}</div>
                            <div class="design-actions">
                                <button class="btn-cart ${cartButtonClass}" 
                                        onclick="${cartOnClick}"
                                        title="${!isLoggedIn ? 'Please login to add to cart' : (!hasCompleteProfile ? 'Please complete your profile first' : (isInCart ? 'Remove from cart' : 'Add to cart with customization'))}">
                                    ${cartButtonText}
                                </button>
                                <button class="btn-wishlist ${wishlistButtonClass}" 
                                        onclick="${wishlistOnClick}"
                                        title="${!isLoggedIn ? 'Please login to add to wishlist' : (!hasCompleteProfile ? 'Please complete your profile first' : (isInWishlist ? 'Remove from wishlist' : 'Add to wishlist'))}">
                                    ${wishlistButtonText}
                                </button>
                            </div>
                            ${!isLoggedIn ? `
                                <div class="login-required-message">
                                    <p>üîê Please login to manage your cart and wishlist</p>
                                    <a href="login.html" class="btn-login-small">Login Now</a>
                                </div>
                            ` : (!hasCompleteProfile ? `
                                <div class="profile-required-message">
                                    <p>üìù Please complete your profile with address, mobile, and district to start shopping</p>
                                    <button class="btn-profile-small" onclick="openUpdateProfileModal()">Complete Profile</button>
                                </div>
                            ` : '')}
                        </div>
                    </div>
                `;
            });

            designsHTML += '</div>';
            container.innerHTML = designsHTML;
        }

        // Customization Modal Functions
        function openCustomizationModal(designName, price, image, designId) {
            if (!currentUser) {
                showLoginRequired();
                return;
            }
            
            if (!isProfileComplete()) {
                showProfileRequired();
                return;
            }

            // Store the design being customized
            currentCustomizationDesign = {
                name: designName,
                price: price,
                image: image,
                id: designId
            };

            // Reset form
            document.getElementById('customizationForm').reset();
            document.getElementById('designWidth').value = '';
            document.getElementById('designHeight').value = '';
            document.getElementById('customRequirements').value = '';

            // Update modal title
            document.getElementById('customizationModalTitle').textContent = `Customize: ${designName}`;

            // Show modal
            const modal = document.getElementById('customizationModal');
            modal.style.display = 'flex';
        }

        function closeCustomizationModal() {
            const modal = document.getElementById('customizationModal');
            modal.style.display = 'none';
            currentCustomizationDesign = null;
            
            // Reset form fields
            document.querySelectorAll('input[name="gender"]').forEach(radio => {
                radio.checked = false;
            });
            
            // Reset dropdowns
            document.getElementById('tshirtColor').value = '';
            document.getElementById('tshirtType').value = '';
            
            // Reset size buttons
            document.querySelectorAll('.size-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            document.querySelector('.size-option[data-size="M"]').classList.add('selected');
            document.getElementById('selectedSize').value = 'M';
            
            // Reset other fields
            document.getElementById('designSide').value = '';
            document.getElementById('placementPosition').value = '';
            document.getElementById('designWidth').value = '';
            document.getElementById('designHeight').value = '';
            document.getElementById('customRequirements').value = '';
        }

        // Size selection
        function selectSize(element) {
            document.querySelectorAll('.size-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            element.classList.add('selected');
            const size = element.getAttribute('data-size');
            document.getElementById('selectedSize').value = size;
            updateCustomizationPreview();
        }

        // Update the customization preview function to include new options
        function updateCustomizationPreview() {
            const gender = document.querySelector('input[name="gender"]:checked');
            const color = document.getElementById('tshirtColor').value;
            const size = document.getElementById('selectedSize').value;
            const tshirtType = document.getElementById('tshirtType').value;
            const designSide = document.getElementById('designSide').value;
            const placementPosition = document.getElementById('placementPosition').value;
            const width = parseInt(document.getElementById('designWidth').value) || 0;
            const height = parseInt(document.getElementById('designHeight').value) || 0;
            const customRequirements = document.getElementById('customRequirements').value;
            const calculatedPrice = width * height * 10;
            
            // Format display names
            const colorDisplay = color ? color.charAt(0).toUpperCase() + color.slice(1) : 'Not selected';
            const tshirtTypeDisplay = tshirtType ? 
                tshirtType.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ') : 
                'Not selected';
            
            // Update preview text
            document.getElementById('previewGender').textContent = `Gender: ${gender ? gender.value : 'Not selected'}`;
            document.getElementById('previewColor').textContent = `Color: ${colorDisplay}`;
            document.getElementById('previewSize').textContent = `Size: ${size}`;
            document.getElementById('previewTshirtType').textContent = `T-Shirt Type: ${tshirtTypeDisplay}`;
            document.getElementById('previewSide').textContent = `Side: ${designSide || 'Not selected'}`;
            document.getElementById('previewPosition').textContent = `Position: ${placementPosition || 'Not selected'}`;
            document.getElementById('previewDesignSize').textContent = `Design Size: ${width && height ? `${width}cm √ó ${height}cm` : 'Not specified'}`;
            document.getElementById('previewRequirements').textContent = `Requirements: ${customRequirements || 'None'}`;
            
            // Update price
            const priceElement = document.getElementById('previewPrice');
            if (width > 0 && height > 0) {
                priceElement.textContent = `Calculated Price: ‚Çπ${calculatedPrice}`;
                priceElement.style.color = '#28a745';
            } else {
                priceElement.textContent = 'Price: Enter dimensions to calculate';
                priceElement.style.color = '#dc3545';
            }
        }

        function handleCustomizationSubmit(event) {
            event.preventDefault();
            
            if (!currentCustomizationDesign) {
                showNotification('No design selected for customization', 'remove');
                return;
            }

            // Get all form values including new dropdowns
            const gender = document.querySelector('input[name="gender"]:checked');
            const tshirtColor = document.getElementById('tshirtColor').value;
            const tshirtSize = document.getElementById('selectedSize').value;
            const tshirtType = document.getElementById('tshirtType').value;
            const designSide = document.getElementById('designSide').value;
            const placementPosition = document.getElementById('placementPosition').value;
            const designWidth = parseInt(document.getElementById('designWidth').value) || 0;
            const designHeight = parseInt(document.getElementById('designHeight').value) || 0;
            const customRequirements = document.getElementById('customRequirements').value.trim();

            // Validation for all required fields
            if (!gender) {
                showNotification('Please select gender', 'remove');
                return;
            }

            if (!tshirtColor) {
                showNotification('Please select t-shirt color', 'remove');
                return;
            }

            if (!tshirtSize) {
                showNotification('Please select size', 'remove');
                return;
            }

            if (!tshirtType) {
                showNotification('Please select t-shirt type', 'remove');
                return;
            }

            // Existing validation
            if (!designSide) {
                showNotification('Please select design side', 'remove');
                return;
            }

            if (!placementPosition) {
                showNotification('Please select placement position', 'remove');
                return;
            }

            if (designWidth <= 0 || designHeight <= 0) {
                showNotification('Please enter valid dimensions (greater than 0)', 'remove');
                return;
            }

            // Calculate price
            const calculatedPrice = designWidth * designHeight * 10;
            
            // Show price confirmation
            if (!confirm(`Price for ${designWidth}cm √ó ${designHeight}cm design: ‚Çπ${calculatedPrice}\n\nClick OK to add to cart.`)) {
                return;
            }

            // Add to cart with all customization data
            addToCartWithCustomization(
                currentCustomizationDesign.name,
                calculatedPrice,
                currentCustomizationDesign.image,
                designSide,
                placementPosition,
                designWidth,
                designHeight,
                customRequirements,
                gender.value,
                tshirtColor,
                tshirtSize,
                tshirtType
            );

            // Close modal
            closeCustomizationModal();
        }

        // Add to cart with customization data
        function addToCartWithCustomization(designName, basePrice, image, designSide, placementPosition, designWidth, designHeight, customRequirements, gender, tshirtColor, tshirtSize, tshirtType) {
            if (!currentUser) {
                showLoginRequired();
                return;
            }
            
            if (!isProfileComplete()) {
                showProfileRequired();
                return;
            }

            // Calculate price based on dimensions: width √ó height √ó 10
            const calculatedPrice = designWidth * designHeight * 10;
            
            console.log('üéØ Adding to cart with customization:', {
                designName, 
                calculatedPrice,
                designWidth, 
                designHeight, 
                designSide, 
                placementPosition,
                gender,
                tshirtColor,
                tshirtSize,
                tshirtType,
                customRequirements
            });

            const existingItemIndex = cart.findIndex(item => 
                item.name === designName && 
                item.design_side === designSide &&
                item.design_width === designWidth &&
                item.design_height === designHeight &&
                item.gender === gender &&
                item.tshirt_color === tshirtColor &&
                item.tshirt_size === tshirtSize &&
                item.tshirt_type === tshirtType
            );
            
            if (existingItemIndex !== -1) {
                // Item already in cart - REMOVE it
                cart.splice(existingItemIndex, 1);
                showNotification(`üóëÔ∏è ${designName} removed from cart!`, 'remove');
            } else {
                // Item not in cart - ADD it with customization and calculated price
                const cartItem = {
                    name: designName,
                    price: calculatedPrice,
                    quantity: 1,
                    image: image,
                    placement_position: placementPosition,
                    design_side: designSide,
                    design_width: parseInt(designWidth),
                    design_height: parseInt(designHeight),
                    custom_requirements: customRequirements,
                    gender: gender,
                    tshirt_color: tshirtColor,
                    tshirt_size: tshirtSize,
                    tshirt_type: tshirtType,
                    calculated_price: calculatedPrice
                };
                
                console.log('üõí Cart item being added:', cartItem);
                cart.push(cartItem);
                showNotification(`‚úÖ ${designName} added to cart! Price: ‚Çπ${calculatedPrice}`, 'success');
            }

            // Save and sync
            saveCartToStorage();
            updateCartBadges();
            renderDesigns(designs);
            
            // Force sync to database
            syncCartToDatabase().then(() => {
                console.log('üîÑ Cart sync completed');
                verifyCartSaved();
            });
        }

        // Verify cart was saved to database
        async function verifyCartSaved() {
            if (!currentUser) return;
            
            try {
                const response = await fetch(`/getUserData/${currentUser.username}`);
                const result = await response.json();
                
                if (result.success) {
                    console.log('‚úÖ Cart verification - Database cart:', result.cart);
                    console.log('‚úÖ Cart verification - Local cart:', cart);
                }
            } catch (error) {
                console.error('‚ùå Cart verification failed:', error);
            }
        }

        // Fix the syncCartToDatabase function
        async function syncCartToDatabase() {
            if (!currentUser) {
                console.log('‚ùå No user logged in, cannot sync cart');
                return;
            }

            try {
                console.log('üîÑ Syncing cart to database:', cart);
                
                const response = await fetch('/syncUserData', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        username: currentUser.username,
                        cart: cart,
                        wishlist: null // Skip wishlist sync
                    })
                });
                
                const result = await response.json();
                console.log("‚úÖ Cart sync response:", result);
                return result;
            } catch (error) {
                console.error('‚ùå Error syncing cart to database:', error);
                throw error;
            }
        }

        // Add this new function for direct cart removal
        function removeFromCart(designName) {
            if (!currentUser) {
                showLoginRequired();
                return;
            }
            
            if (!isProfileComplete()) {
                showProfileRequired();
                return;
            }

            // Find the item in cart
            const existingItemIndex = cart.findIndex(item => item.name === designName);
            
            if (existingItemIndex !== -1) {
                // Ask for confirmation before removing
                if (confirm(`Are you sure you want to remove "${designName}" from your cart?`)) {
                    // Remove from cart
                    cart.splice(existingItemIndex, 1);
                    showNotification(`üóëÔ∏è ${designName} removed from cart!`, 'remove');
                    
                    // Save and sync
                    saveCartToStorage();
                    updateCartBadges();
                    renderDesigns(designs);
                    
                    // Force sync to database
                    syncCartToDatabase().then(() => {
                        console.log('üîÑ Cart sync completed after removal');
                    });
                }
            } else {
                showNotification('Item not found in cart', 'remove');
            }
        }

        // Cart functionality - UPDATED with profile completion check
        function addToCart(designName, price, image) {
            if (!currentUser) {
                showLoginRequired();
                return;
            }
            
            if (!isProfileComplete()) {
                showProfileRequired();
                return;
            }

            const existingItemIndex = cart.findIndex(item => item.name === designName);
            
            if (existingItemIndex !== -1) {
                // Item already in cart - REMOVE it
                cart.splice(existingItemIndex, 1);
                showNotification(`üóëÔ∏è ${designName} removed from cart!`, 'remove');
            } else {
                // Item not in cart - ADD it
                cart.push({
                    name: designName,
                    price: price,
                    quantity: 1,
                    image: image
                });
                showNotification(`‚úÖ ${designName} added to cart!`, 'success');
            }

            saveCartToStorage();
            updateCartBadges();
            renderDesigns(designs);
            syncCartToDatabase();
        }

        // Wishlist functionality - UPDATED with profile completion check
        function addToWishlist(designName, price, image) {
            if (!currentUser) {
                showLoginRequired();
                return;
            }
            
            if (!isProfileComplete()) {
                showProfileRequired();
                return;
            }

            const existingItemIndex = wishlist.findIndex(item => item.name === designName);
            
            if (existingItemIndex !== -1) {
                // Item already in wishlist - REMOVE it
                wishlist.splice(existingItemIndex, 1);
                showNotification(`üíî ${designName} removed from wishlist!`, 'remove');
            } else {
                // Item not in wishlist - ADD it
                wishlist.push({
                    name: designName,
                    price: price,
                    image: image
                });
                showNotification(`‚ù§Ô∏è ${designName} added to wishlist!`, 'success');
            }

            saveWishlistToStorage();
            updateCartBadges();
            renderDesigns(designs);
            syncWishlistToDatabase();
        }

        // Sync ONLY cart to database (skip wishlist)
        async function syncCartToDatabase() {
            if (!currentUser) return;

            try {
                await fetch('/syncUserData', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        username: currentUser.username,
                        cart: cart,
                        wishlist: null // Skip wishlist sync
                    })
                });
                console.log("‚úÖ Cart synced to database");
            } catch (error) {
                console.error('Error syncing cart to database:', error);
            }
        }

        // Sync ONLY wishlist to database (skip cart)
        async function syncWishlistToDatabase() {
            if (!currentUser) return;

            try {
                await fetch('/syncUserData', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        username: currentUser.username,
                        cart: null, // Skip cart sync
                        wishlist: wishlist
                    })
                });
                console.log("‚úÖ Wishlist synced to database");
            } catch (error) {
                console.error('Error syncing wishlist to database:', error);
            }
        }

        // Show notification with different types
        function showNotification(message, type = 'success') {
            // Create notification element
            const notification = document.createElement('div');
            
            const colors = {
                success: '#28a745', // Green for add
                remove: '#dc3545',  // Red for remove
                info: '#17a2b8'     // Blue for info
            };
            
            const color = type === 'remove' ? colors.remove : colors.success;
            
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${color};
                color: white;
                padding: 15px 20px;
                border-radius: 5px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                font-weight: bold;
                animation: slideIn 0.3s ease-out;
            `;
            
            // Add CSS animation
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.remove();
                style.remove();
            }, 3000);
        }

        // Update cart and wishlist badges
        function updateCartBadges() {
            const cartCount = document.getElementById('cartCount');
            const wishlistCount = document.getElementById('wishlistCount');
            
            if (cartCount) {
                const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                cartCount.textContent = totalItems;
                cartCount.style.display = totalItems > 0 ? 'flex' : 'none';
            }
            
            if (wishlistCount) {
                wishlistCount.textContent = wishlist.length;
                wishlistCount.style.display = wishlist.length > 0 ? 'flex' : 'none';
            }
        }

        // Local storage functions
        function saveCartToStorage() {
            if (currentUser) {
                localStorage.setItem(`cart_${currentUser.username}`, JSON.stringify(cart));
            }
        }

        function loadCartFromStorage() {
            if (currentUser) {
                const savedCart = localStorage.getItem(`cart_${currentUser.username}`);
                if (savedCart) {
                    try {
                        cart = JSON.parse(savedCart);
                        console.log(`üì¶ Loaded ${cart.length} cart items from localStorage`);
                    } catch (e) {
                        console.error('Error parsing cart from localStorage:', e);
                        cart = [];
                    }
                } else {
                    console.log('üì¶ No cart found in localStorage');
                    cart = [];
                }
            } else {
                cart = [];
            }
        }

        function loadWishlistFromStorage() {
            if (currentUser) {
                const savedWishlist = localStorage.getItem(`wishlist_${currentUser.username}`);
                if (savedWishlist) {
                    try {
                        wishlist = JSON.parse(savedWishlist);
                        console.log(`‚ù§Ô∏è Loaded ${wishlist.length} wishlist items from localStorage`);
                    } catch (e) {
                        console.error('Error parsing wishlist from localStorage:', e);
                        wishlist = [];
                    }
                } else {
                    console.log('‚ù§Ô∏è No wishlist found in localStorage');
                    wishlist = [];
                }
            } else {
                wishlist = [];
            }
        }
// Toggle profile dropdown menu
function toggleProfileMenu(event) {
    event.stopPropagation(); // Prevent immediate closing
    const dropdownMenu = document.getElementById('profileDropdownMenu');
    dropdownMenu.classList.toggle('show');
}

// Close profile dropdown when clicking outside
document.addEventListener('click', function(event) {
    const dropdownMenu = document.getElementById('profileDropdownMenu');
    const profileToggle = document.querySelector('.profile-menu-toggle');
    
    if (dropdownMenu && profileToggle && 
        !dropdownMenu.contains(event.target) && 
        !profileToggle.contains(event.target)) {
        dropdownMenu.classList.remove('show');
    }
});

// Prevent dropdown from closing when clicking inside it
document.addEventListener('click', function(event) {
    const dropdownMenu = document.getElementById('profileDropdownMenu');
    if (dropdownMenu && dropdownMenu.contains(event.target)) {
        event.stopPropagation();
    }
});
        function saveWishlistToStorage() {
            if (currentUser) {
                localStorage.setItem(`wishlist_${currentUser.username}`, JSON.stringify(wishlist));
            }
        }

        // Show login required message
        function showLoginRequired() {
            showNotification('üîê Please login to use this feature', 'remove');
            
            // Optional: Auto-redirect to login after 2 seconds
            setTimeout(() => {
                if (confirm('You need to login to continue. Go to login page?')) {
                    window.location.href = 'login.html';
                }
            }, 2000);
        }

        // Toggle profile dropdown menu
        function toggleProfileMenu() {
            const dropdownMenu = document.getElementById('profileDropdownMenu');
            dropdownMenu.classList.toggle('show');
        }

        // Close profile dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdownMenu = document.getElementById('profileDropdownMenu');
            const profileToggle = document.querySelector('.profile-menu-toggle');
            
            if (dropdownMenu && profileToggle && 
                !dropdownMenu.contains(event.target) && 
                !profileToggle.contains(event.target)) {
                dropdownMenu.classList.remove('show');
            }
        });

        // Update authentication buttons
        function updateAuthButtons() {
            const authButtons = document.getElementById('authButtons');
            
            if (currentUser) {
                authButtons.innerHTML = `
                    <div class="user-info">
                        <div class="cart-badge">
                            <a href="cart.html" style="color: white; text-decoration: none;">üõí Cart</a>
                            <span class="badge" id="cartCount">0</span>
                        </div>
                        <div class="wishlist-badge">
                            <a href="wishlist.html" style="color: white; text-decoration: none;">‚ù§Ô∏è Wishlist</a>
                            <span class="badge" id="wishlistCount">0</span>
                        </div>
                        <div class="profile-dropdown">
                            <a href="javascript:void(0);" onclick="toggleProfileMenu()" style="color: white; text-decoration: none;">üë§ Profile</a>
                            <div class="profile-dropdown-menu" id="profileDropdownMenu">
                                <div class="profile-header">
                                    <img src="${currentUser.profile_pic || 'https://via.placeholder.com/80'}" alt="Profile" class="profile-avatar">
                                    <h4 class="profile-username">${currentUser.username}</h4>
                                    <p class="profile-email">${currentUser.email || 'No email'}</p>
                                </div>
                                <div class="profile-menu-items">
                                    <button class="profile-menu-item" onclick="openUpdateProfileModal()">
                                        üë§ Update Profile
                                    </button>
                                    <button class="profile-menu-item logout" onclick="logout()">
                                        üö™ Logout
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                authButtons.innerHTML = `
                    <a href="login.html" class="btn btn-login">Login</a>
                    <a href="register.html" class="btn btn-register">Register</a>
                `;
            }
        }

        // Profile Modal Functions
        function openUpdateProfileModal() {
            const modal = document.getElementById('profileModal');
            modal.style.display = 'flex';
            
            // Populate current user data
            if (currentUser) {
                document.getElementById('profileAddress').value = currentUser.address || '';
                document.getElementById('profileMobile').value = currentUser.mobile || '';
                document.getElementById('profileDistrict').value = currentUser.district || '';
            }
            
            // Add form submit handler
            document.getElementById('profileForm').onsubmit = handleProfileUpdate;
        }

        function closeProfileModal() {
            const modal = document.getElementById('profileModal');
            modal.style.display = 'none';
        }

        async function handleProfileUpdate(event) {
            event.preventDefault();
            
            if (!currentUser) {
                showNotification('Please login to update profile', 'remove');
                return;
            }
            
            const address = document.getElementById('profileAddress').value.trim();
            const mobile = document.getElementById('profileMobile').value.trim();
            const district = document.getElementById('profileDistrict').value;
            
            // Validation
            if (!address) {
                showNotification('Please enter your address', 'remove');
                return;
            }
            
            if (!mobile) {
                showNotification('Please enter your mobile number', 'remove');
                return;
            }
            
            if (!/^\d{10}$/.test(mobile)) {
                showNotification('Please enter a valid 10-digit mobile number', 'remove');
                return;
            }
            
            if (!district) {
                showNotification('Please select your district', 'remove');
                return;
            }
            
            try {
                const saveBtn = document.querySelector('.btn-save');
                saveBtn.textContent = 'üíæ Saving...';
                saveBtn.disabled = true;
                
                // Prepare update data - send base64 only if a new picture was selected
                const updateData = {
                    username: currentUser.username,
                    address: address,
                    mobile: mobile,
                    district: district,
                    profilePic: profilePicBase64 || currentUser.profile_pic || ""
                };
                
                console.log('Updating profile:', {
                    ...updateData,
                    profilePic: updateData.profilePic ? `Base64 data (${updateData.profilePic.length} chars)` : 'No image'
                });
                
                const response = await fetch('/updateProfile', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(updateData)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    // Update local storage with new data
                    currentUser.address = result.address;
                    currentUser.mobile = result.mobile;
                    currentUser.district = result.district;
                    currentUser.profile_pic = result.profile_pic; // This should be a URL from the backend
                    
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    
                    showNotification('‚úÖ Profile updated successfully!', 'success');
                    closeProfileModal();
                    
                    // Refresh designs to update button states and update user avatar
                    renderDesigns(designs);
                    updateAuthButtons(); // This will update the avatar in navigation
                } else {
                    throw new Error(result.error || 'Failed to update profile');
                }
                
            } catch (error) {
                console.error('Profile update error:', error);
                showNotification(`‚ùå Error: ${error.message}`, 'remove');
            } finally {
                const saveBtn = document.querySelector('.btn-save');
                saveBtn.textContent = 'üíæ Save Profile';
                saveBtn.disabled = false;
            }
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    if (modal.id === 'profileModal') closeProfileModal();
                    if (modal.id === 'customizationModal') closeCustomizationModal();
                    if (modal.id === 'imagePreviewModal') closeImagePreview();
                }
            });
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeProfileModal();
                closeCustomizationModal();
                closeImagePreview();
            }
        });

        // Logout function
        function logout() {
            // Sync data before logout
            syncCartToDatabase();
            syncWishlistToDatabase();
                    
            localStorage.removeItem('currentUser');
            currentUser = null;
            cart = [];
            wishlist = [];
            
            updateAuthButtons();
            renderDesigns(designs);
            window.location.href = 'index.html';
        }

        // Search functionality with auto-search
        function performSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            
            if (searchTerm === '') {
                renderDesigns(designs);
                return;
            }
            
            const filteredDesigns = designs.filter(design => {
                return design.name.toLowerCase().includes(searchTerm) ||
                       (design.category && design.category.toLowerCase().includes(searchTerm)) ||
                       (design.description && design.description.toLowerCase().includes(searchTerm));
            });
            
            renderDesigns(filteredDesigns);
            
            // Show search results info
            const container = document.getElementById('designsContainer');
            if (filteredDesigns.length === 0) {
                container.innerHTML = `
                    <div class="error">
                        <h3>No Designs Found</h3>
                        <p>No designs match your search for "${searchTerm}"</p>
                        <button class="retry-btn" onclick="clearSearch()">Show All Designs</button>
                    </div>
                `;
            } else {
                // Add search results info
                const resultsInfo = document.createElement('div');
                resultsInfo.className = 'search-results-info';
                resultsInfo.innerHTML = `
                    <p>Found ${filteredDesigns.length} design(s) for "${searchTerm}"</p>
                    <button class="btn-clear-search" onclick="clearSearch()">Clear Search</button>
                `;
                
                // Insert before the designs grid
                const designsGrid = container.querySelector('.designs-grid');
                if (designsGrid) {
                    container.insertBefore(resultsInfo, designsGrid);
                }
            }
        }

        function clearSearch() {
            document.getElementById('searchInput').value = '';
            renderDesigns(designs);
        }

        // Image Preview Functions
        let currentPreviewDesign = null;

        function openImagePreview(encodedDesign) {
            const design = JSON.parse(decodeURIComponent(encodedDesign));
            currentPreviewDesign = design; // Store globally for access in other functions
            
            const modal = document.getElementById('imagePreviewModal');
            
            // Set basic design info
            document.getElementById('previewDesignName').textContent = design.name;
            document.getElementById('previewDesignPrice').textContent = `‚Çπ${design.price}`;
            document.getElementById('previewDesignDescription').textContent = design.description || 'No description available.';
            
            // Load preview images for this design
            loadDesignPreviewsForCustomer(design.id);
            
            modal.style.display = 'flex';
        }

        // Load preview images for customer view
        async function loadDesignPreviewsForCustomer(designId) {
            try {
                const response = await fetch(`/admin/designs/${designId}/previews`);
                const result = await response.json();
                
                const previewContainer = document.getElementById('previewThumbnails');
                const mainImageElem = document.getElementById('previewImage');
                
                // Get main image from currentPreviewDesign
                const mainImageSrc = currentPreviewDesign.image_data ? 
                    `data:${currentPreviewDesign.image_type};base64,${currentPreviewDesign.image_data}` : 
                    'https://via.placeholder.com/600x400?text=No+Image';
                
                // Set main image
                mainImageElem.src = mainImageSrc;
                mainImageElem.alt = currentPreviewDesign.name;
                
                // Clear existing thumbnails
                previewContainer.innerHTML = '';
                
                // Add main image as first thumbnail
                const mainThumb = document.createElement('div');
                mainThumb.className = 'preview-thumbnail active';
                mainThumb.innerHTML = `<img src="${mainImageSrc}" alt="Main Image" onclick="switchPreviewImage('${mainImageSrc}', this)">`;
                previewContainer.appendChild(mainThumb);
                
                // Add preview images as thumbnails
                if (result.success && result.previews.length > 0) {
                    result.previews.forEach(preview => {
                        const imageSrc = `data:${preview.preview_type};base64,${preview.preview_data}`;
                        const thumb = document.createElement('div');
                        thumb.className = 'preview-thumbnail';
                        thumb.innerHTML = `<img src="${imageSrc}" alt="Preview" onclick="switchPreviewImage('${imageSrc}', this)">`;
                        previewContainer.appendChild(thumb);
                    });
                }
                
                // Show/hide navigation based on number of images
                updatePreviewNavigation(previewContainer.children.length);
                
            } catch (error) {
                console.error('Error loading preview images:', error);
                // Fallback to just the main image
                const mainImageSrc = currentPreviewDesign.image_data ? 
                    `data:${currentPreviewDesign.image_type};base64,${currentPreviewDesign.image_data}` : 
                    'https://via.placeholder.com/600x400?text=No+Image';
                document.getElementById('previewImage').src = mainImageSrc;
            }
        }

        // Switch between preview images
        function switchPreviewImage(imageSrc, element) {
            // Update main image
            const mainImageElem = document.getElementById('previewImage');
            mainImageElem.src = imageSrc;
            
            // Update active thumbnail
            document.querySelectorAll('.preview-thumbnail').forEach(thumb => {
                thumb.classList.remove('active');
            });
            element.parentElement.classList.add('active');
        }

        // Navigation functions for preview images
        function navigatePreview(direction) {
            const thumbnails = document.querySelectorAll('.preview-thumbnail');
            if (thumbnails.length <= 1) return; // No navigation needed if only one image
            
            const activeIndex = Array.from(thumbnails).findIndex(thumb => thumb.classList.contains('active'));
            
            let newIndex;
            if (direction === 'next') {
                newIndex = (activeIndex + 1) % thumbnails.length;
            } else {
                newIndex = (activeIndex - 1 + thumbnails.length) % thumbnails.length;
            }
            
            // Simulate click on the new thumbnail
            const newThumb = thumbnails[newIndex];
            const img = newThumb.querySelector('img');
            switchPreviewImage(img.src, img);
        }

        // Update preview navigation visibility
        function updatePreviewNavigation(totalImages) {
            const previewNav = document.getElementById('previewNav');
            if (previewNav) {
                previewNav.style.display = totalImages > 1 ? 'flex' : 'none';
            }
        }

        function closeImagePreview() {
            const modal = document.getElementById('imagePreviewModal');
            modal.style.display = 'none';
            currentPreviewDesign = null; // Clear the stored design
        }

        // Fix search input text color
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            
            // Force white text color
            searchInput.style.color = 'white';
            searchInput.style.setProperty('color', 'white', 'important');
            
            // Update color on input
            searchInput.addEventListener('input', function() {
                this.style.color = 'white';
                this.style.setProperty('color', 'white', 'important');
            });
            
            // Update color on focus
            searchInput.addEventListener('focus', function() {
                this.style.color = 'white';
                this.style.setProperty('color', 'white', 'important');
            });
        });

        // Initialize the app when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initApp();
            
            // Add event listeners for customization modal
            // Gender radio buttons
            document.querySelectorAll('input[name="gender"]').forEach(radio => {
                radio.addEventListener('change', updateCustomizationPreview);
            });
            
            // New dropdowns
            const tshirtColor = document.getElementById('tshirtColor');
            const tshirtType = document.getElementById('tshirtType');
            
            tshirtColor.addEventListener('change', updateCustomizationPreview);
            tshirtType.addEventListener('change', updateCustomizationPreview);
            
            // Existing event listeners
            const designSide = document.getElementById('designSide');
            const placementPosition = document.getElementById('placementPosition');
            const designWidth = document.getElementById('designWidth');
            const designHeight = document.getElementById('designHeight');
            const customRequirements = document.getElementById('customRequirements');
            
            designSide.addEventListener('change', updateCustomizationPreview);
            placementPosition.addEventListener('change', updateCustomizationPreview);
            designWidth.addEventListener('input', updateCustomizationPreview);
            designHeight.addEventListener('input', updateCustomizationPreview);
            customRequirements.addEventListener('input', updateCustomizationPreview);
            
            // Initial update
            updateCustomizationPreview();
        });
    </script>

    <!-- Update Profile Modal -->
    <div id="profileModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üë§ Update Profile</h3>
                <button class="close-btn" onclick="closeProfileModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="profileForm">
                    <!-- Profile Picture Section -->
                    <div class="form-group">
                        <label for="profilePicInput">Profile Picture (Optional)</label>
                        <div class="profile-pic-container">
                            <div class="profile-pic-preview">
                                <img id="profilePicPreview" src="" alt="Profile Preview" class="profile-preview-image">
                            </div>
                            <input type="file" id="profilePicInput" class="form-control-file" 
                                   accept="image/*" onchange="previewProfileImage(this)">
                            <small class="file-help">Click to upload profile picture (Max 2MB, JPG/PNG)</small>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="profileAddress">Address *</label>
                        <textarea id="profileAddress" class="form-control" rows="3" placeholder="Enter your address" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="profileMobile">Mobile Number *</label>
                        <input type="tel" id="profileMobile" class="form-control" 
                               placeholder="Enter 10-digit mobile number" maxlength="10" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="profileDistrict">District *</label>
                        <select id="profileDistrict" class="form-control" required>
                            <option value="">Select District</option>
                            <option value="Tirupur">Tirupur</option>
                            <option value="Coimbatore">Coimbatore</option>
                            <option value="Erode">Erode</option>
                            <option value="Chennai">Chennai</option>
                            <option value="Bangalore">Bangalore</option>
                        </select>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn-cancel" onclick="closeProfileModal()">Cancel</button>
                        <button type="submit" class="btn-save">üíæ Save Profile</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Design Customization Modal - UPDATED WITH NEW OPTIONS -->
    <div id="customizationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="customizationModalTitle">Customize Design</h3>
                <button class="close-btn" onclick="closeCustomizationModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="customizationForm" onsubmit="handleCustomizationSubmit(event)">
                    <!-- New Options Grid -->
                    <div class="customization-options-grid">
                        <!-- Gender Selection -->
                        <div class="option-group">
                            <label for="gender">Gender <span class="customization-required">*</span></label>
                            <div class="radio-group" id="genderOptions">
                                <div class="radio-option">
                                    <input type="radio" id="male" name="gender" value="male" required>
                                    <label for="male">Male</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="female" name="gender" value="female" required>
                                    <label for="female">Female</label>
                                </div>
                            </div>
                        </div>

                        <!-- Color Selection - DROPDOWN -->
                        <div class="option-group">
                            <label for="tshirtColor">T-Shirt Color <span class="customization-required">*</span></label>
                            <select id="tshirtColor" class="form-control color-dropdown" required>
                                <option value="">Select Color</option>
                                <option value="black" style="color: #000000; background: #f8f9fa;">‚¨§ Black</option>
                                <option value="white" style="color: #000000; background: #ffffff; border: 1px solid #ddd;">‚¨§ White</option>
                                <option value="blue" style="color: #007bff; background: #f8f9fa;">‚¨§ Blue</option>
                                <option value="red" style="color: #dc3545; background: #f8f9fa;">‚¨§ Red</option>
                                <option value="green" style="color: #28a745; background: #f8f9fa;">‚¨§ Green</option>
                                <option value="yellow" style="color: #ffc107; background: #f8f9fa;">‚¨§ Yellow</option>
                                <option value="maroon" style="color: #800000; background: #f8f9fa;">‚¨§ Maroon</option>
                                <option value="navy" style="color: #000080; background: #f8f9fa;">‚¨§ Navy</option>
                            </select>
                        </div>

                        <!-- Size Selection -->
                        <div class="option-group">
                            <label for="tshirtSize">Size <span class="customization-required">*</span></label>
                            <div class="size-options" id="sizeOptions">
                                <div class="size-option" data-size="S" onclick="selectSize(this)">S</div>
                                <div class="size-option" data-size="M" onclick="selectSize(this)">M</div>
                                <div class="size-option" data-size="L" onclick="selectSize(this)">L</div>
                                <div class="size-option" data-size="XL" onclick="selectSize(this)">XL</div>
                                <div class="size-option" data-size="2XL" onclick="selectSize(this)">2XL</div>
                                <div class="size-option" data-size="3XL" onclick="selectSize(this)">3XL</div>
                            </div>
                            <input type="hidden" id="selectedSize" name="tshirtSize" value="M" required>
                        </div>

                        <!-- T-Shirt Type Selection - DROPDOWN -->
                        <div class="option-group">
                            <label for="tshirtType">T-Shirt Type <span class="customization-required">*</span></label>
                            <select id="tshirtType" class="form-control" required>
                                <option value="">Select Type</option>
                                <option value="round-neck">Round Neck</option>
                                <option value="collar">Collar</option>
                                <option value="v-neck">V-Neck</option>
                                <option value="polo">Polo</option>
                            </select>
                        </div>
                    </div>

                    <!-- Existing Design Customization Fields -->
                    <div class="customization-form-grid">
                        <div class="form-group">
                            <label for="designSide">Design Side <span class="customization-required">*</span></label>
                            <select id="designSide" class="form-control" required>
                                <option value="">Select Side</option>
                                <option value="Front">Front</option>
                                <option value="Back">Back</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="placementPosition">Placement Position <span class="customization-required">*</span></label>
                            <select id="placementPosition" class="form-control" required>
                                <option value="">Select Position</option>
                                <option value="LEFT TOP">LEFT TOP</option>
                                <option value="LEFT CENTER">LEFT CENTER</option>
                                <option value="LEFT BOTTOM">LEFT BOTTOM</option>
                                <option value="CENTER TOP">CENTER TOP</option>
                                <option value="CENTER">CENTER</option>
                                <option value="CENTER BOTTOM">CENTER BOTTOM</option>
                                <option value="RIGHT TOP">RIGHT TOP</option>
                                <option value="RIGHT CENTER">RIGHT CENTER</option>
                                <option value="RIGHT BOTTOM">RIGHT BOTTOM</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="designSize">Design Size (in cm) <span class="customization-required">*</span></label>
                        <div class="size-inputs">
                            <input type="number" id="designWidth" class="form-control" placeholder="Width" min="1" max="100" required>
                            <span class="size-unit">√ó</span>
                            <input type="number" id="designHeight" class="form-control" placeholder="Height" min="1" max="100" required>
                            <span class="size-unit">cm</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="customRequirements">Custom Requirements (Optional)</label>
                        <textarea id="customRequirements" class="form-control" rows="3" placeholder="Any specific requirements or notes for the design..."></textarea>
                    </div>
                    
                    <div class="customization-preview">
                        <h4>Customization Summary</h4>
                        <p id="previewGender">Gender: Not selected</p>
                        <p id="previewColor">Color: Not selected</p>
                        <p id="previewSize">Size: M</p>
                        <p id="previewTshirtType">T-Shirt Type: Not selected</p>
                        <p id="previewSide">Side: Not selected</p>
                        <p id="previewPosition">Position: Not selected</p>
                        <p id="previewDesignSize">Design Size: Not specified</p>
                        <p id="previewRequirements">Requirements: None</p>
                        <p id="previewPrice" class="price-preview">Price: Enter dimensions to calculate</p>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn-cancel" onclick="closeCustomizationModal()">Cancel</button>
                        <button type="submit" class="btn-save">‚úÖ Add to Cart</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Image Preview Modal -->
    <div id="imagePreviewModal" class="modal">
        <div class="modal-content image-modal-content">
            <div class="modal-header">
                <h3 id="previewTitle">Design Preview</h3>
                <button class="close-btn" onclick="closeImagePreview()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Preview Gallery -->
                <div class="preview-gallery">
                    <img id="previewImage" src="" alt="Design Preview" class="preview-image">
                    
                    <!-- Preview Navigation -->
                    <div class="preview-nav" id="previewNav">
                        <button onclick="navigatePreview('prev')">‚Üê Previous</button>
                        <button onclick="navigatePreview('next')">Next ‚Üí</button>
                    </div>
                </div>
                
                <!-- Preview Thumbnails -->
                <div class="preview-thumbnails" id="previewThumbnails">
                    <!-- Thumbnails will be added here by JavaScript -->
                </div>
                
                <!-- Design Info -->
                <div class="preview-info">
                    <h4 id="previewDesignName"></h4>
                    <p id="previewDesignPrice" class="price"></p>
                    <p id="previewDesignDescription" class="description"></p>
                </div>
            </div>
        </div>
    </div>
</body>
</html><script>
// Mobile menu toggle functionality
// Mobile menu toggle functionality
// Mobile menu toggle functionality
document.addEventListener('DOMContentLoaded', function() {
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const mobileNav = document.getElementById('mobileNav');
    const mobileNavOverlay = document.createElement('div');
    
    // Create overlay element
    mobileNavOverlay.className = 'mobile-nav-overlay';
    document.body.appendChild(mobileNavOverlay);
    
    if (mobileMenuToggle && mobileNav) {
        mobileMenuToggle.addEventListener('click', function() {
            mobileNav.classList.toggle('show');
            mobileNavOverlay.classList.toggle('show');
            const isExpanded = mobileNav.classList.contains('show');
            this.setAttribute('aria-expanded', isExpanded);
            this.textContent = isExpanded ? '‚úï' : '‚ò∞';
            
            // Prevent body scroll when menu is open
            document.body.style.overflow = isExpanded ? 'hidden' : '';
        });

        // Close mobile menu when clicking on overlay
        mobileNavOverlay.addEventListener('click', function() {
            mobileNav.classList.remove('show');
            this.classList.remove('show');
            mobileMenuToggle.textContent = '‚ò∞';
            mobileMenuToggle.setAttribute('aria-expanded', 'false');
            document.body.style.overflow = '';
        });

        // Close mobile menu when clicking on a link
        const navLinks = mobileNav.querySelectorAll('a');
        navLinks.forEach(link => {
            link.addEventListener('click', function() {
                mobileNav.classList.remove('show');
                mobileNavOverlay.classList.remove('show');
                mobileMenuToggle.textContent = '‚ò∞';
                mobileMenuToggle.setAttribute('aria-expanded', 'false');
                document.body.style.overflow = '';
            });
        });

        // Close mobile menu when pressing Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape' && mobileNav.classList.contains('show')) {
                mobileNav.classList.remove('show');
                mobileNavOverlay.classList.remove('show');
                mobileMenuToggle.textContent = '‚ò∞';
                mobileMenuToggle.setAttribute('aria-expanded', 'false');
                document.body.style.overflow = '';
            }
        });
    }
});
</script>
